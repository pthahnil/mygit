<!DOCTYPE html>
<html>
  <head>
    <title>employees</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">
    
    <link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
	<script type="text/javascript" src="easyui/jquery.js"></script>
	<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="easyui/locale/easyui-lang-zh_CN.js"></script>
  </head>
  
  <body>
  	<div style="height: 450px">
		<table class="easyui-datagrid" id="dg" title="角色信息" fit="true" toolbar="#toolbar"
				data-options="singleSelect:true,collapsible:true,url:'employee!getAll.action',pagination:true">
			<thead>	
		  		<tr>
		  			<th data-options="field:'id',width:30">编号</th>
		  			<th data-options="field:'ename',width:80">姓名</th>
		  			<th data-options="field:'age',width:80">年龄</th>
		  			<th data-options="field:'gender',width:100">性别</th>
		  			<th data-options="field:'phone',width:80">电话</th>
		  			<th data-options="field:'duties',width:80">职务</th>
		  			<th data-options="field:'did',width:80,hidden:true">部门编号</th>
		  			<th data-options="field:'dname',width:80">部门名称</th>
		  		</tr>
			</thead>
	  	</table>
  	</div>
  	<div id="toolbar">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="newUser()">添加用户</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="editUser()">编辑用户</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="deleteUser()">删除用户</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-import" plain="true" onclick="importUser()">批量导入</a>
    </div>
    
    <div id="dlg" class="easyui-dialog" style="width:400px;height:350px;padding:10px 20px"
            closed="true" buttons="#dlg-buttons">
        <form id="fm" method="post">
        	<table cellspacing="10px;">
        		<tr>
        			<td>姓名：</td>
        			<td><input name="ename" class="easyui-validatebox" required="true" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>年龄：</td>
        			<td><input name="age" class="easyui-validatebox" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>性别：</td>
        			<td><input name="gender" type="radio" value="0" >男<input name="gender" type="radio" value="1" >女</td>
        		</tr>
        		<tr>
        			<td>电话：</td>
        			<td><input name="phone" class="easyui-validatebox" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>职务：</td>
        			<td><input name="duties" class="easyui-validatebox"  style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>部门：</td>
        			<td><input class="easyui-combobox" id="dept" name="did"
							data-options="valueField:'did',textField:'dname',url:'dept!getCombo.action',panelHeight:'auto'"></td>
        		</tr>
        	</table>
        </form>
       </div>
    <div id="impdlg" class="easyui-dialog" style="width:400px;height:350px;padding:10px 20px"
            closed="true" buttons="#dlg-buttons">
        <form id="impfm" method="post">
        	<table cellspacing="10px;">
        		<tr>
        			<td>部门：</td>
        			<td><input class="easyui-combobox" id="dept" name="did"
							data-options="valueField:'did',textField:'dname',url:'dept!getCombo.action',panelHeight:'auto'"></td>
        		</tr>
        	</table>
        </form>
       </div>
       
       <div id="dlg-buttons">
			<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" onclick="saveUser()">保存</a>
			<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')">关闭</a>
		</div>
	
  </body>
  <script type="text/javascript">
  	var url;
	function newUser(){
		$("#dlg").dialog('open').dialog('setTitle','添加用户');
		$('#fm').form('clear');
		url='employee!add.action';
	}

	function editUser(){
		var row = $('#dg').datagrid('getSelected');
		if(row){
			$("#dlg").dialog('open').dialog('setTitle','编辑用户');
			$('#fm').form('load',row);
			url = 'employee!add.action?id='+row.id;
		}
	} 

	function saveUser(){
		$("#fm").form('submit',{
			url:url,
			onSubmit:function(){
				return $(this).form('validate');
			},success:function(res){
				var result=eval('('+res+')');
				if(result.msg){
					$.messager.alert("系统提示",result.msg);
					return;
				}else{
					$.messager.alert("系统提示","保存成功！");
					$('#dlg').dialog('close');
					$("#dg").datagrid("reload");
				}
				
			}
		})
	}

	function deleteUser(){
		var row = $('#dg').datagrid('getSelected');
		if(row){
			$.messager.confirm("系统提示","你确定要删除该记录？",function(r){
				if(r){
					$.post('employee!delete.action',{id:row.id},function(res){
						if(res.msg){
							$.messager.alert("系统提示","删除失败！");
						}else{
							$.messager.alert("系统提示","删除成功！");
							$('#dg').datagrid('reload');
						}
					});
				}
			});
		}
	}
	
	function importUser(){
		$("#impdlg").dialog('open').dialog('setTitle','导入用户数据');
	}
  </script>
</html>
