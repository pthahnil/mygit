<!DOCTYPE html>
<html>
  <head>
    <title>modules</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">
    
    <link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
	<script type="text/javascript" src="easyui/jquery.js"></script>
	<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="easyui/locale/easyui-lang-zh_CN.js"></script>
  </head>
  
  <body>
  	<div style="height: 450px">
		<table class="easyui-datagrid" id="dg" title="角色信息" fit="true" toolbar="#toolbar"
				data-options="singleSelect:true,collapsible:true,url:'module!getAll.action',pagination:true">
			<thead>	
		  		<tr>
		  			<th data-options="field:'id',width:30">编号</th>
		  			<th data-options="field:'mname',width:80">模块名称</th>
		  			<th data-options="field:'url',width:80">url</th>
		  			<th data-options="field:'route',width:100">路径</th>
		  			<th data-options="field:'orderNum',width:80">排序号</th>
		  		</tr>
			</thead>
	  	</table>
  	</div>
  	<div id="toolbar">
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="newModule()">添加模块</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="editModule()">编辑模块</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="deleteModule()">删除模块</a>
    </div>
    
    <div id="dlg" class="easyui-dialog" style="width:400px;height:350px;padding:10px 20px"
            closed="true" buttons="#dlg-buttons">
        <form id="fm" method="post">
        	<table cellspacing="10px;">
        		<tr>
        			<td>模块名称：</td>
        			<td><input name="mname" class="easyui-validatebox" required="true" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>url：</td>
        			<td><input name="url" class="easyui-validatebox" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>路径：</td>
        			<td><input name="route" class="easyui-validatebox" style="width: 200px;"></td>
        		</tr>
        		<tr>
        			<td>排序号：</td>
        			<td><input name="orderNum" class="easyui-validatebox"  style="width: 200px;"></td>
        		</tr>
        	</table>
        </form>
       </div>
       
       <div id="dlg-buttons">
			<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" onclick="saveModule()">保存</a>
			<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')">关闭</a>
		</div>
	
  </body>
  <script type="text/javascript">
  	var url;
	function newModule(){
		$("#dlg").dialog('open').dialog('setTitle','添加模块');
		$('#fm').form('clear');
		url='module!add.action';
	}
	
	function editModule(){
		var row = $("#dg").datagrid('getSelected');
		if(row){
			$("#dlg").dialog('open').dialog('setTitle','编辑模块');
			$("#fm").form("load",row);
			url = "module!add.action?id="+row.id;
		}
	}
	
	function saveModule(){
		$("#fm").form('submit',{
			url:url,
			onSubmit:function(){
				return $(this).form('validate');
			},success:function(res){
				var result=eval('('+res+')');
				if(result.msg){
					$.messager.alert("系统提示",result.msg);
					return;
				}else{
					$.messager.alert("系统提示","保存成功！");
					$('#dlg').dialog('close');
					$("#dg").datagrid("reload");
				}
				
			}
		})
	}
	
  </script>
</html>
